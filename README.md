# Текстовые утилиты

Все улилиты выполнены в виде функций класса `tpl`. Практически каждая функция может 
быть вызвана как в статическом, так и в классическом виде. Вызов статического 
синонима, как правило, более компактен, однако в классическом виде можно настроить 
формат вывода более гибко. Впрочем, обычно это не нужно.

## Использование

    use Ksnk\text\tpl;
    
    echo tpl::text('',$data);
    
## установка

    composer require ksnk/text
    
По сути - там один файл, поковыряйтесь в репозитории, скопируйте его себе и делайте с ним что угодно.            

## Вывод числа прописью

При выводе числа учитывается склонение. Женский род помечается символом `+`, 
при указании второго параметра функции

    $number=101;
    //'сто один баран на поле', склонение в мужском роде - один-два
    tpl::text('{prop} на поле', [
        'prop'=>tpl::prop($number,"баран||а|ов")]);
    );
    // проверка склонения в женском роде одна-две вместо один-два
    //'сто одна овца на поле',
    tpl::text('{prop} на поле', [
        'prop'=>tpl::prop($number,"+овц|а|ы|ец")]) ;
        
Классический вывод цены с копейками        

    $tpl=new tpl();
    echo $tpl->num2str(23456.45, tpl::RUB, true);
    // двадцать три тысячи четыреста пятьдесят шесть рублей 45 копеек
    
    echo tpl:prop(23456.45, tpl::RUB, true);
 
## Вывод русской даты

К удивлению, в PHP отсутствует возможность вывода даты по русски, с названиями в 
родительном падеже. Только именительный. Как же так?

    setlocale(LC_ALL, 'ru_RU', 'ru_RU.UTF-8', 'ru', 'russian');
    echo strftime("%B %d, %Y", time()).PHP_EOL;
    // Октябрь 25, 2022

    $tpl->toRusDate(time()); // 25 октября, 2022 г.
    tpl::rusd(time(), "j F"); // 25 октября.
    
Используется формат даты для обычного вывода даты по английски.    

## plural

Окончания для числительных. Параметр в строковом виде, `ОДИН, ТРИ, ПЯТЬ`, 
разделенных `|`. Для статического способа вызова более компактная форма вызова.

    echo $tpl->plural(25, 'копейка', 'копейки', 'копеек');
    echo 25.' копе'.tpl::pl(25,'йка|йки|ек');
    
Впрочем, самостоятельного применения практически не имеет, только в составе шаблона.    

## tpl::text

Форматированный вывод с подстановкой значений. В текстовой строке указываются 
имена переменных в фигурных скобках, которые при форматировании заменяются 
своими значениями. Имеется минимальная логика, которая помогает мастерить более 
менее корректные письма, в зависимости от имеющихся данных

    $data=[
        'first_name'=>'Вассисуалий',
        'second_name'=>'Лоханкин',
        'joined'=>'2022-10-15'
    ];
    
    echo tpl::text('Уважаемый {first_name}{ second_name}!', $data);
    
Пробел в начале описателя второго параметра выводится, в случае, если второй параметр 
не пуст. В случае, если второй параметр отсутствует в данных, восклицательный знак 
не отделяется пробелом. 

    echo tpl::text('Уважаемый {joined?подписчик:посетитель}!', $data);
  
Минимальная логика, в зависимости от значения  `joined` выводится первый или второй 
операнд логического оператора

    echo tpl::text('Уважаемый {first_name?:посетитель}!', $data);
    
Условный оператор в виде  `?:` имеет несколько отличающуюся от очевидной логику вывода. 
Если параметр не пуст, выводится он, если пуст - выводится значение по умолчанию.
   
    $data['number]=23;
    echo tpl::text('{number} баран{||а|ов} на поле!', $data);
    // 23 барана на поле
    
Числительный оператор. Оператор, в котором присутствует 3 символа `|`.
 Можно использовать в 2-х формах, полная -  `{25||а|ов}` и сокращенная `{||а|ов}`, 
 в последнем случае числовое значение берется из последнего подмененного шаблона. 
    

## tpl::utext

Отличается от text тем, что используются двойные фигурные скобки вместо одинарных 
для определения границ праметров в тексте. В остальном логика и операторы шаблонов
одинаковы.
В определенной степени, шаблоны включают в себя шаблонный язык шаблонов Unisender. 
Во всяком случае - я обрабатываю шаблоны, скачанные оттуда именно в этом  режиме. 
Несколько большие, по сравнению с Unisender возможности не конфликтуют.
 
## tpl::sql

Является экспериментальным режимом работы шаблонизатора. Позволяет готовить 
sql запросы в достаточно экзотических условиях. Не рекомендуется
для широкого применения. Пользой этого режима является единообразие 
sql вне зависимости от используемых CMS, что позволяет писать более 
переносимые с системы на систему модули.